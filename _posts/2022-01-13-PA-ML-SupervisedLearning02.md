---
layout: post
title: "[AI] ML - 머신러닝 성능 평가"
subtitle: "SupervisedLearning02"
categories: python
tags: ai
comments: true
---

# 머신러닝 성능 평가
> 교차검증: 데이터 편중을 막기 위해서 별도의 여러 세트로 구성된 trainSet(학습 데이터 세트)과 validationSet(검증 데이터 세트)에서 학습과 평가를 수행한다. (과적합 방지 효과)
>> 대부분의 ML 모델의 성능 평가는 교차 검증 기반으로 1차 평가를 한 뒤에 최종적으로 testSet(테스트 데이터 세트)에 적용해 평가하는 프로세스이다.

### 교차검증 종류
- K 폴드
    - 보편적으로 사용
    - K개의 데이터 폴드 세트를 만들어서 K번만큼 각 폴트 세트에 학습과 검증 평가를 반복 수행
    - 교차 검증 최종 평가 = K개 평가의 평균
- Stratified K 폴드
    - 불균형한 분포도를 가진 레이블 데이터 집합을 위한 K 폴드 방식
    - 불균형한 분포도를 가진 레이블 데이터 집합: 특정 레이블 값이 특이하게 많거나 매우 적어서 값의 분포가 한쪽으로 치우치는 것을 뜻함
    - 원본 데이터의 레이블 분포를 먼저 고려한 뒤 이 분포와 동일하게 학습과 검증 데이터 세트를 분배

> 즉, 분류에서의 교차 검증은 Stratified K 폴드가 좋음다.<br>회귀에서는 이산값이 아니라 연속된 숫자값이기 때문에 사용하지 못한다.
<br>
### 교차검증 함수
- cross_val_score()
    - 교차 검증을 간편하게 수행할 수 있게 해주는 API
    - 내부적으로 Classifier가 입력되면 Stratified K 폴드, Regressor가 입력되면 K 폴드 방식으로 분할됨
    - 단 하나의 평가 지표만 사용 가능(accuracy)

- cross_validate()
    - cross_val_score()와 비슷하지만, 여러 개의 평가 지표를 반환할 수 있으며, 성능 평가 지표와 수행 시간도 같이 제공.
    - 그러나 보통 cross_val_score() 하나로도 대부분의 경우 쉽게 사용함
<br>
### 교차 검증과 최적 하이퍼 파라미터 튜닝
- GridSearchCV

> 일반적인 머신러닝 방법은 학습 데이터로 GridSearchCV를 이용해 최적 하이퍼 파라미터를 튜닝을 수행한 뒤 별도의 테스트 세트에서 이를 평가한다.

